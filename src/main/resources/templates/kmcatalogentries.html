<!DOCTYPE html>
<html>
    <head>
        <title>KM Catalog Home</title>
		<meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<link rel="stylesheet" type="text/css" th:href="@{/css/styles.css}" href="../../css/styles.css"/>
        <script th:src="@{/js/lib/jquery-3.1.1.min.js}" src="../../js/lib/jquery-3.1.1.min.js" type="text/javascript"></script>

    <script>
        $('document').ready(function () {
            url = '/public/api/documentcategories';
            getDataFromWebService(url);
        });

        function getDataFromWebService(targetUrl) {
            $.ajax({
                type: "GET", //method type of GET
                url: targetUrl, //url passed to function
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data, status, jqXHR) { //on successful ajax call
                    //jsonToTable(data); //put JSON array data into table
                },
                error: function (jqXHR, status) { //if not successful
                    console.log(status); //log error to javascript console
                }
            });
        }

        //function to organize returned JSON string data into a table
        function jsonToTable(json) {
            var $table = $('#tblJSONData'); //create table variable from DOM table object
            $table.empty(); //clear the table
            for (var i = 0; i < json.length; i++) { //iterate through JSON array
                var $row = $('<tr />'); //create new table row
                //append JSON properties to the row's cells
                $row.append('<td>' + json[i].id + '</td>');
                $row.append('<td>' + json[i].categoryName + '</td>');
                $table.append($row); //append the row with values to the table
            }
        }
    </script>

    </head>
    <body>
		<header>
			<h1 data-th-inline="text"><img th:src="@{/images/logo.jpg}" alt=""/>Knowledge Management System</h1>
		</header>
		<section id="nav">
			<nav>
				<ul>
                    <li><a th:href="@{/kmcatalogentries}">Home</a></li>
                    <li><a th:href="@{/documentcategories}">Document Categories</a></li>
                    <li><a th:href="@{/products}">Products</a></li>
                    <li><a th:href="@{/departments}">Departments</a></li>
                    <li><a th:href="@{/communities}">Communities</a></li>
				</ul>
			</nav>
		</section>
		<section class="content">
			<div>
				<table id="catalog">
					<tr>
						<th>ID</th>
						<th>Title</th>
						<th>Owner</th>
						<th>Audience</th>
						<th>Category</th>
						<th>Community</th>
                        <th>Product</th>
						<th>Filename</th>
					</tr>                
					<tr data-th-each="entry : ${kmcatalogentries}">
						<td data-th-text="${entry.id}"></td>
						<td data-th-text="${entry.documentTitle}"></td>
						<td data-th-text="${entry.knowledgeOwner}"></td>
						<td data-th-text="${entry.audience}"></td>
						<td data-th-text="${entry.documentCategory}"></td>
						<td data-th-text="${entry.community}"></td>
                        <td data-th-text="${entry.product}"></td>
						<td data-th-text="${entry.documentFilename}"></td>
					</tr>
				</table>
			</div>
			<hr />
			<div id="addEntry">
				<h2>Add Entry to KM Catalog</h2>
				<form data-th-action="@{/kmcatalogentries/add}" name="addKMCatalogEntryForm" method="post">
					Title: <input type="text" name="documentTitle" /><br />
					Knowledge Owner: <input type="text" name="knowledgeOwner" /><br />
					Audience: <input type="text" name="audience" /><br />
					Document Category:<br />
					<input type="radio" name="documentCategory" value="Unknown" checked="checked" /> Unknown<br />
					<input type="radio" name="documentCategory" value="Best_Practice" /> Best Practice<br />
					<input type="radio" name="documentCategory" value="Design" /> Design<br />
					<input type="radio" name="documentCategory" value="Lessons_Learned" /> Lessons Learned<br />
					<input type="radio" name="documentCategory" value="Procedure" /> Procedure<br />
					<input type="radio" name="documentCategory" value="Reference" /> Reference<br />
					<input type="radio" name="documentCategory" value="Requirements" /> Requirements<br />
					<input type="radio" name="documentCategory" value="Standard" /> Standard<br />
					<input type="radio" name="documentCategory" value="Template" /> Template<br />
					<input type="radio" name="documentCategory" value="Training" /> Training<br />
					<input type="radio" name="documentCategory" value="User_Documentation" /> User Documentation<br />	
					Community:<br />
					<input type="radio" name="community" value="Everyone" checked="checked" /> Everyone<br />
					<input type="radio" name="community" value="Chemical_Engineers" /> Chemical Engineers<br />
					<input type="radio" name="community" value="Electrical_Engineers" /> Electrical Engineers<br />
					<input type="radio" name="community" value="Mechanical_Engineers" /> Mechanical Engineers<br />
					<input type="radio" name="community" value="System_Administration" /> System Administration<br />
					<input type="radio" name="community" value="Developers" /> Developers<br />
                    Product:<br />
                    <input type="radio" name="product" value="none" checked="checked" /> n/a<br />
                    <input type="radio" name="product" value="Product A" /> Product A<br />
                    <input type="radio" name="product" value="Product B" /> Product B<br />
                    <input type="radio" name="product" value="Product C" /> Product C<br />
					Filename: <input type="text" name="documentFilename" /><br />
					<input class="button" type="submit" value="Add Catalog Entry"/>
				</form> 
                <table id="tblJSONData" border="1" cellpadding="2"></table>
			</div>
			<hr />
			<div id="submitEntry">
				<form data-th-action="@{/logout}" method="post">
						<input class="button" type="submit" value="Sign Out"/>
				</form>
			</div>
        </section>     
    </body>
</html>